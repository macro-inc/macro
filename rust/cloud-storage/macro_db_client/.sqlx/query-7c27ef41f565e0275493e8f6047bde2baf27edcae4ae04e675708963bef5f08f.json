{
  "db_name": "PostgreSQL",
  "query": "\n    WITH PinnedItems AS (\n        SELECT\n            p.\"pinnedItemId\" as pin_item_id,\n            p.\"pinnedItemType\" as pin_item_type,\n            p.\"pinIndex\" as pin_index\n        FROM \"Pin\" p\n        WHERE p.\"userId\" = $1\n    ), Combined AS (\n        SELECT\n            'document' as \"item_type!\",\n            d.id as \"id!\",\n            CAST(COALESCE(di.id, db.id) as TEXT) as \"document_version_id\",\n            d.owner as \"user_id!\",\n            d.name as \"name!\",\n            d.\"branchedFromId\" as \"branched_from_id\",\n            d.\"branchedFromVersionId\" as \"branched_from_version_id\",\n            d.\"documentFamilyId\" as \"document_family_id\",\n            d.\"fileType\" as \"file_type\",\n            d.\"createdAt\"::timestamptz as \"created_at\",\n            d.\"updatedAt\"::timestamptz as \"updated_at\",\n            d.\"projectId\" as \"project_id\",\n            di.sha as \"sha\",\n            NULL as \"is_persistent\",\n            pi.pin_index as \"pin_index\"\n        FROM \"Document\" d\n        INNER JOIN PinnedItems pi ON pi.pin_item_id = d.id AND pi.pin_item_type = 'document'\n        LEFT JOIN LATERAL (\n            SELECT\n                b.id\n            FROM\n                \"DocumentBom\" b\n            WHERE\n                b.\"documentId\" = d.id\n            ORDER BY\n                b.\"createdAt\" DESC\n            LIMIT 1\n        ) db ON true\n        LEFT JOIN LATERAL (\n            SELECT\n                i.id,\n                i.\"documentId\",\n                i.\"sha\",\n                i.\"createdAt\",\n                i.\"updatedAt\"\n            FROM\n                \"DocumentInstance\" i\n            WHERE\n                i.\"documentId\" = d.id\n            ORDER BY\n                i.\"updatedAt\" DESC\n            LIMIT 1\n        ) di ON true\n        UNION ALL\n        SELECT\n            'chat' as \"item_type!\",\n            c.id as \"id!\",\n            NULL as \"document_version_id\",\n            c.\"userId\" as \"user_id!\",\n            c.name as \"name!\",\n            NULL as \"branched_from_id\",\n            NULL as \"branched_from_version_id\",\n            NULL as \"document_family_id\",\n            NULL as \"file_type\",\n            c.\"createdAt\"::timestamptz as \"created_at\",\n            c.\"updatedAt\"::timestamptz as \"updated_at\",\n            c.\"projectId\" as \"project_id\",\n            NULL as \"sha\",\n            c.\"isPersistent\" as \"is_persistent\",\n            pi.pin_index as \"pin_index\"\n        FROM \"Chat\" c\n        INNER JOIN PinnedItems pi ON pi.pin_item_id = c.id AND pi.pin_item_type = 'chat'\n        UNION ALL\n        SELECT\n            'project' as \"item_type!\",\n            p.id as \"id!\",\n            NULL as \"document_version_id\",\n            p.\"userId\" as \"user_id!\",\n            p.name as \"name!\",\n            NULL as \"branched_from_id\",\n            NULL as \"branched_from_version_id\",\n            NULL as \"document_family_id\",\n            NULL as \"file_type\",\n            p.\"createdAt\"::timestamptz as \"created_at\",\n            p.\"updatedAt\"::timestamptz as \"updated_at\",\n            p.\"parentId\" as \"project_id\",\n            NULL as \"sha\",\n            NULL as \"is_persistent\",\n            pi.pin_index as \"pin_index\"\n        FROM \"Project\" p\n        INNER JOIN PinnedItems pi ON pi.pin_item_id = p.id AND pi.pin_item_type = 'project'\n    )\n    SELECT * FROM Combined\n    ORDER BY pin_index ASC\n    ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "item_type!",
        "type_info": "Text"
      },
      {
        "ordinal": 1,
        "name": "id!",
        "type_info": "Text"
      },
      {
        "ordinal": 2,
        "name": "document_version_id",
        "type_info": "Text"
      },
      {
        "ordinal": 3,
        "name": "user_id!",
        "type_info": "Text"
      },
      {
        "ordinal": 4,
        "name": "name!",
        "type_info": "Text"
      },
      {
        "ordinal": 5,
        "name": "branched_from_id",
        "type_info": "Text"
      },
      {
        "ordinal": 6,
        "name": "branched_from_version_id",
        "type_info": "Int8"
      },
      {
        "ordinal": 7,
        "name": "document_family_id",
        "type_info": "Int8"
      },
      {
        "ordinal": 8,
        "name": "file_type",
        "type_info": "Text"
      },
      {
        "ordinal": 9,
        "name": "created_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 10,
        "name": "updated_at",
        "type_info": "Timestamptz"
      },
      {
        "ordinal": 11,
        "name": "project_id",
        "type_info": "Text"
      },
      {
        "ordinal": 12,
        "name": "sha",
        "type_info": "Text"
      },
      {
        "ordinal": 13,
        "name": "is_persistent",
        "type_info": "Bool"
      },
      {
        "ordinal": 14,
        "name": "pin_index",
        "type_info": "Int4"
      }
    ],
    "parameters": {
      "Left": [
        "Text"
      ]
    },
    "nullable": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ]
  },
  "hash": "7c27ef41f565e0275493e8f6047bde2baf27edcae4ae04e675708963bef5f08f"
}
